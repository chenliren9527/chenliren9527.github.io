---
title: 就业技术加强(06)-源码分析(1)
tags:
  - 笔记
  - 就业技术加强
  - 源码分析
  - Spring
  - Mybatis
categories:
  - 就业技术加强
abbrlink: 4620
date: 2021-01-29 18:26:26
---

### 01-Mybatis执行流程

**目标**：导入演示工程及回顾mybatis执行流程

**小结**：

1、导入示例工程；

2、导入数据库数据；

3、mybatis的执行流程：配置文件解析、执行流程

### 02-DEBUG操作说明

**目标**：能够说出和使用IDEA的调试模式中8个按钮功能

**小结**：

![image-20210129085310838](就业技术加强-06-源码分析-1.assets/image-20210129085310838.png)

```
1、显示执行点：回到当前断点执行处，常用在调试多处时要回到当下断点执行地方的时候
2、执行并跳到下一行：执行完当前断点所在行并跳转到下一行
3、（步入）进入方法：根据当前行进入对应的方法，如果是多个方法则可选择进入；所以是进入某个方法的意思
4、（强制步入）进入方法；与上述一样；只是它可以进入JDK等原生方法，能力更强
5、（步出）退出方法：与步入是反操作，可以在进入方法之后退出该方法并跳转到进入方法的入口处（不能再进入方法执行）
6、回退上一步：可以回退到进入某个方法入口处并可重新进入方法；常用于需要多次调试进入某个方法的时候
7、执行到光标处：将断点执行到光标所在行
8、表达式计算：可以对断点过程中的变量、表达式等进行计算
```



### 03-解析-properties源码

**目标**：能够说出properties的4种属性及对应加载的优先级

**小结**：

在解析的过程中会解析如下四个地方的配置；

- 解析properties——》property
- 解析 properties 中的属性 `resources` 或者解析 `url`
- 获取到外层传递进来的 `Properties`

如果上述的地方存在同名的配置项的话；那么配置项的优先级按照上面的顺序倒序



### 04-解析-settings与environments源码

**目标**：查看settings中可使用的属性及多个environment的时候如何选择使用哪个环境

**小结**：

- settings属性它里面可以配置的配置项
  - 每个配置项必须是在 `configuration`里面定义
  - 每个配置项大小写敏感
- environments配置
  - 必须要设置 `default`属性
  - 子节点必须要有一个与  `default`中指定的相同

### 05-解析-mappers源码

**目标**：解析mappers后再configuration中得到了什么？

**小结**：

在解析 `/configuration/mappers`的时候；会进行mapper文件的检验，解析完之后会得到一个 `mappedStatements`并设置到 `configuration`

### 06-了解SqlSessionManager作用

**目标**：能够说出SqlSessionManager的特点

**小结**：

特点：同时实现了 `SqlsessionFactory` 和  `SqlSession` 也就是同时拥有这两个接口的功能

```java
        SqlSessionManager sqlSessionManager = SqlSessionManager.newInstance(sqlSessionFactory);
        sqlSessionManager.startManagedSession();
        User user2 = sqlSessionManager.selectOne("com.itheima.mybatis.mapper.UserMapper.findById", 1);
        System.out.println(user2);

        sqlSessionManager.close();

```



### 07-创建SqlSession源码

**目标**：了解在创建SqlSession时创建的`Executor` 使用的设计模式

**小结**：

![image-20210129101948050](就业技术加强-06-源码分析-1.assets/image-20210129101948050.png)

![image-20210129102038932](就业技术加强-06-源码分析-1.assets/image-20210129102038932.png)



### 08-执行原生查询源码

**目标**：了解在执行查询后缓存key结构，及SqlSession缓存（一级缓存）使用特点

**小结**：

缓存key结构：

> 1349536878:23967270:com.itheima.mybatis.mapper.UserMapper.findById:0:2147483647:select * from tb_user where id = ?:1:dev

SqlSession缓存是使用了 `CachingExecutor` 执行器，在执行之前判断上述的key是否存在缓存数据，如果存在则直接返回；如果不存在则查询数据库，并在查询完之后设置到缓存中。

![image-20210129110925754](就业技术加强-06-源码分析-1.assets/image-20210129110925754.png)

### 09-执行接口查询源码

**目标**：区别接口查询与原生查询

**小结**：

使用了Mapper方式进行操作的话：

![image-20210129111818485](就业技术加强-06-源码分析-1.assets/image-20210129111818485.png)

区别：

如果使用了Mapper方式操作，那么它在获取到对应的Mapper对象的时候是一个代理对象，在执行的时候，会先处理一系列的其它操作之后执行 `sqlSession`里面的方法最终完成数据库操作的。这样做的好处：提供开发效率、代码通用性。

### 10-Mybatis架构设计

**目标**：Executor执行器及StatementHandler的子类特点

**小结**：

![image-20210129112939595](就业技术加强-06-源码分析-1.assets/image-20210129112939595.png)

### 11-Mybatis常见面试题

**目标**：能够说出Mybatis常见面试题答案

**小结**：详见《讲义》

### 12-Spring工厂体系结构

**目标**：区别 ClassPathXmlApplicationContext 与 ApplicationContext

**小结**：

ClassPathXmlApplicationContext  是实现了 ApplicationContext 接口的子类；拥有该接口的功能。

![image-20210129145426101](就业技术加强-06-源码分析-1.assets/image-20210129145426101.png)

ClassPathXmlApplicationContext  可以在类的根路径下加载配置文件创建、初始化ioc容器。

### 13-容器初始化-核心源码及流程

**目标**：能够说出容器初始化主要操作

**小结**：

![image-20210129150434856](就业技术加强-06-源码分析-1.assets/image-20210129150434856.png)

### 14-创建BeanFactory与单例Bean源码

**目标**：了解Spring的BeanFactory与单例Bean创建

**小结**：

- BeanFactory在创建的时候主要获取spring配置文件中对应的bean定义——》解析成 `BeanDefinition` 为后续的Bean初始化提供信息；

![image-20210129153216767](就业技术加强-06-源码分析-1.assets/image-20210129153216767.png)

- Bean在初始的时候，从工厂中获取 `BeanDefinition`先创建对象，之后再通过 `populateBean`初始Bean对象中的属性值

![image-20210129153320282](就业技术加强-06-源码分析-1.assets/image-20210129153320282.png)



### 15-Spring常见面试题

**目标**：能够说出Spring常见面试题的答案

**小结**：

aop使用场景：

- 日志：一般情况下，是在调用第三方的api的时候可以通过aop进行记录
- 事务：降低重复代码，提高开发效率

其它详见《讲义》