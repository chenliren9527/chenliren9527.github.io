---
title: 小程序代码的构成
tags:
  - 小程序
  - 微信
  - 笔记
categories:
  - 微信小程序
date: 2023-04-05 21:08:33
---

# 小程序代码的构成

## 了解项目的基本组成结构

![](%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9E%84%E6%88%90.assets/image-20230404153006487.png)

1. pages 用来存放所有小程序的页面

2. 用来存放工具性质的模块（例如：格式化时间的自定义模块）

3. app.js 小程序项目的入口文件

4. app.json 小程序项目的全局配置文件

5. app.wxss 小程序项目的全局样式文件

6. project.config.json 项目的配置文件

7. sitemap.json 用来配置小程序及其页面是否允许被微信索引

## 小程序页面的组成部分

程序官方建议把所有小程序的页面，都存放在 pages 目录中，以单独的文件夹存在，如图所示



![image-20230404153237926](%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9E%84%E6%88%90.assets/image-20230404153237926.png)

其中，每个页面由 4 个基本文件组成，它们分别是：

1. js 文件（页面的脚本文件，存放页面的数据、事件处理函数等）

2. json 文件（当前页面的配置文件，配置窗口的外观、表现等）

3. wxml 文件（页面的模板结构文件）

4. wxss 文件（当前页面的样式表文件）

### JSON配置文件的作用

JSON 是一种数据格式，在实际开发中，JSON 总是以**配置文件**的形式出现。小程序项目中也不例外：通过不同的 .json 配置文件，可以对小程序项目进行不同级别的配置。

小程序项目中有 4 种 json 配置文件，分别是：

1. 项目根目录中的 app.json 配置文件

2. 项目根目录中的 project.config.json 配置文件

3. 项目根目录中的 sitemap.json 配置文件

4. 每个页面文件夹中的 .json 配置文件

#### 1. app.json 文件

app.json 是当前小程序的**全局配置**，包括了小程序的所有页面路径、窗口外观、界面表现、底部 tab 等。Demo 项目里边的 app.json 配置内容如下：

![image-20230404153618524](%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9E%84%E6%88%90.assets/image-20230404153618524.png)

简单了解下这 4 个配置项的作用：

1. pages：用来记录当前小程序所有页面的路径

2. window：全局定义小程序所有页面的背景色、文字颜色等

3. style：全局定义小程序组件所使用的样式版本

4. sitemapLocation：用来指明 sitemap.json 的位置

#### 2. project.config.json文件

project.config.json 是项目配置文件，用来记录我们对小程序开发工具所做的个性化配置，例如：

- setting 中保存了编译相关的配置

- projectname 中保存的是项目名称

- appid 中保存的是小程序的账号 ID

#### 3. sitemap.json文件

微信现已开放小程序内搜索，效果类似于 PC 网页的 SEO。sitemap.json 文件用来配置小程序页面是否允许微信索引。

当开发者允许微信索引时，微信会通过爬虫的形式，为小程序的页面内容建立索引。当用户的搜索关键字和页面的索引匹配成功的时候，小程序的页面将可能展示在搜索结果中。

![image-20230404162159762](%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9E%84%E6%88%90.assets/image-20230404162159762.png)



注意：sitemap 的索引提示是默认开启的，如需要关闭 sitemap 的索引提示，可在小程序项目配置文件 project.config.json 的 setting 中配置字段 checkSiteMap 为 false

#### 4. 页面的 **.json** 配置文件

小程序中的每一个页面，可以使用 .json 文件来对本页面的窗口外观进行配置，**页面中的配置项会覆盖** **app.json** **的** **window** **中相同的配置项**。例如：

![image-20230404153856575](%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9E%84%E6%88%90.assets/image-20230404153856575.png)

#### 5. 修改项目首页

只需要调整 app.json -> pages 数组中页面路径的前后顺序，即可修改项目的首页。小程序会把排在第一位的页面，当作项目首页进行渲染，如图所示：

![image-20230404153917680](%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9E%84%E6%88%90.assets/image-20230404153917680.png)

### WXML模板

#### 1. 什么是WXML

WXML（WeiXin Markup Language）是小程序框架设计的一套标签语言，用来构建小程序页面的结构，其作用类似于网页开发中的 HTML。

#### 2. WXML和HTML的区别

1. 标签名称不同

   - HTML （div, span, img, a）


   - WXML（view, text, image, navigator）


2. 属性节点不同

```
<a href="#">超链接</a>
<navigator url="/pages/home/home"></navigator>
```

3. 提供了类似于 Vue 中的模板语法

   - 数据绑定


   - 列表渲染


   - 条件渲染


### WXSS样式

#### 1. 什么是WXSS

WXSS (WeiXin Style Sheets)是一套样式语言，用于描述 WXML 的组件样式，类似于网页开发中的 CSS。

#### 2. WXSS和CSS的区别

1. 新增了 rpx 尺寸单位
   - CSS 中需要手动进行像素单位换算，例如 rem

   - WXSS 在底层支持新的尺寸单位 rpx，在不同大小的屏幕上小程序会自动进行换算


2. 提供了全局的样式和局部样式

   - 项目根目录中的 app.wxss 会作用于所有小程序页面


   - 局部页面的 .wxss 样式仅对当前页面生效


3. WXSS 仅支持部分 CSS 选择器

   - .class 和 #id


   - element


   - 并集选择器、后代选择器


   - ::after 和 ::before 等伪类选择器


### JS逻辑交互

#### 1. 小程序中的 .js 文件

一个项目仅仅提供界面展示是不够的，在小程序中，我们通过 .js 文件来处理用户的操作。例如：响应用户的点击、获取用户的位置等等。

#### 2. 小程序中 .js 文件的分类

小程序中的 JS 文件分为三大类，分别是：

1. app.js

​		是整个小程序项目的入口文件，通过调用 App() 函数来启动整个小程序

2. 页面的 .js 文件

​		是页面的入口文件，通过调用 Page() 函数来创建并运行页面

3. 普通的 .js 文件

​		是普通的功能模块文件，用来封装公共的函数或属性供页面使用































